<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Easy Payment</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f0f2f5;
      margin: 0;
    }

    .container {
      background-color: #ffffff;
      padding: 40px;
      border-radius: 8px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      text-align: center;
      width: 300px;
    }

    h1 {
      color: #333;
      margin-bottom: 15px;
    }

    p {
      color: #666;
      margin-bottom: 25px;
    }

    .pin-form input[type="password"] {
      width: calc(100% - 22px); /* Adjust for padding/border */
      padding: 10px;
      margin-bottom: 15px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1.1em;
      text-align: center; /* Center the input text */
    }

    .pin-form button {
      background-color: #007bff;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1em;
      transition: background-color 0.2s ease-in-out;
    }

    .pin-form button:hover:not(:disabled) {
      background-color: #0056b3;
    }

    .pin-form button:disabled,
    .pin-form input:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }

    #message {
      margin-top: 20px;
      font-weight: bold;
      font-size: 0.9em;
    }

    #message.error {
      color: #dc3545; /* Red for error */
    }

    #message.success {
      color: #28a745; /* Green for success */
    }

    .hidden {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Welcome!</h1>
    <p>Please enter the PIN to gain access.</p>
    <div class="pin-form">
      <input type="password" id="pinInput" placeholder="Enter PIN here" maxlength="4" />
      <button id="submitPin">Enter</button>
      <p id="message" class="hidden"></p>
      <p id="lockoutMessage" class="hidden"></p>
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const hardcodedPin = "1961"; // Your hardcoded PIN here
      const pinInput = document.getElementById('pinInput');
      const submitButton = document.getElementById('submitPin');
      const messageElement = document.getElementById('message');
      const lockoutMessage = document.getElementById('lockoutMessage');

      const MAX_ATTEMPTS = 5;
      const LOCKOUT_DURATION = 5*1000; // 1 hour in milliseconds

      // Load attempt data from localStorage
      let attempts = parseInt(localStorage.getItem('pinAttempts')) || 0;
      let lockoutEnd = parseInt(localStorage.getItem('lockoutEnd')) || 0;

      function disableInputAndButton() {
        pinInput.disabled = true;
        submitButton.disabled = true;
      }

      function enableInputAndButton() {
        pinInput.disabled = false;
        submitButton.disabled = false;
      }

      function updateLockoutStatus() {
        const now = Date.now();

        if (lockoutEnd && now < lockoutEnd) {
          disableInputAndButton();
          lockoutMessage.classList.remove('hidden');
          messageElement.classList.add('hidden');
          startCountdown(lockoutEnd - now);
        } else {
          lockoutMessage.classList.add('hidden');
          enableInputAndButton();
          attempts = 0;
          localStorage.setItem('pinAttempts', attempts);
          localStorage.removeItem('lockoutEnd');
        }
      }

      function startCountdown(duration) {
        let remaining = duration;

        function tick() {
          if (remaining <= 0) {
            lockoutMessage.textContent = '';
            enableInputAndButton();
            attempts = 0;
            localStorage.setItem('pinAttempts', attempts);
            localStorage.removeItem('lockoutEnd');
            return;
          }

          const minutes = Math.floor(remaining / 60000);
          const seconds = Math.floor((remaining % 60000) / 1000);

          lockoutMessage.textContent = `Too many incorrect attempts. Please try again in ${minutes}m ${seconds}s.`;
          remaining -= 1000;
          setTimeout(tick, 1000);
        }

        tick();
      }

      submitButton.addEventListener('click', () => {
        if (pinInput.disabled) return; // Do nothing if disabled

        const enteredPin = pinInput.value.trim();

        messageElement.textContent = '';
        messageElement.classList.add('hidden');
        messageElement.classList.remove('error', 'success');

        if (enteredPin === hardcodedPin) {
          messageElement.textContent = "Access Granted! Redirecting...";
          messageElement.classList.remove('hidden');
          messageElement.classList.add('success');

          // Reset attempts and lockout
          attempts = 0;
          localStorage.setItem('pinAttempts', attempts);
          localStorage.removeItem('lockoutEnd');

          // Redirect to next page
          setTimeout(() => {
            window.location.href = "index.html"; // Change to your actual next page
          }, 1500);
        } else {
          attempts++;
          localStorage.setItem('pinAttempts', attempts);

          if (attempts >= MAX_ATTEMPTS) {
            // Start lockout
            const lockoutUntil = Date.now() + LOCKOUT_DURATION;
            localStorage.setItem('lockoutEnd', lockoutUntil);
            lockoutEnd = lockoutUntil;
            updateLockoutStatus();
          } else {
            messageElement.textContent = "Incorrect PIN. Please try again.";
            messageElement.classList.remove('hidden');
            messageElement.classList.add('error');
          }

          pinInput.value = '';
          pinInput.focus();
        }
      });

      pinInput.addEventListener('keypress', (event) => {
        if (event.key === 'Enter' && !pinInput.disabled) {
          submitButton.click();
        }
      });

      updateLockoutStatus(); // Check lockout status on page load
    });
  </script>
</body>
</html>
